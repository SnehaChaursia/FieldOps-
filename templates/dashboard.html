{% extends "base.html" %}
{% block title %}Dashboard{% endblock %}

{% block content %}

<style>

    /* ---------------- STAT CARDS ---------------- */
    .stat-card {
        border-radius: 18px;
        padding: 28px;
        color: white;
        height: 150px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        transition: 0.25s ease;
    }
    .stat-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 25px rgba(0,0,0,0.25);
    }

    .stat-title {
        font-size: 18px;
        opacity: 0.9;
    }
    .stat-number {
        font-size: 40px;
        font-weight: 800;
    }

    /* GRADIENT COLORS */
    .grad-blue {
        background: linear-gradient(135deg, #3a7bd5, #00d2ff);
    }
    .grad-green {
        background: linear-gradient(135deg, #05c46b, #0be881);
    }
    .grad-red {
        background: linear-gradient(135deg, #ff416c, #ff4b2b);
    }

    /* ---------------- TABLE ---------------- */
    .table-box {
        border-radius: 18px;
        overflow: hidden;
        border: none;
        box-shadow: 0 6px 18px rgba(174, 49, 206, 0.13);
        background: white;
        width: 100%;
    }

    .table {
        width: 100%;
        min-width: 1000px; /* Force wide table */
    }

    .table thead th {
        background: #10253aff;    /* dark light grey */
        color: #f6f7efff;
        padding: 16px;
        font-size: 17px;
        font-weight: 600;
    }

    .table tbody tr {
        height: 65px;
        font-size: 16px;
    }

    .table tbody tr:hover {
        background: #f5f6f7;
    }

    .card-header-custom {
        background: white;
        padding: 22px;
        border-bottom: 2px solid #9c50e4ff;
        font-size: 20px;
        font-weight: 700;
    }

    /* ---------------- BADGES ---------------- */
    .badge-soft-green {
        background: #e8fbe9;
        color: #0e8f3b;
        padding: 7px 14px;
        border-radius: 8px;
        font-weight: 600;
    }
    .badge-soft-red {
        background: #ffe7e7;
        color: #d21f3c;
        padding: 7px 14px;
        border-radius: 8px;
        font-weight: 600;
    }
    .badge-soft-purple {
        background: #f3e8ff;
        color: #7c3aed;
        padding: 7px 14px;
        border-radius: 8px;
        font-weight: 600;
    }

</style>



<div class="container">

    <!-- HEADER -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="fw-bold">Dashboard</h1>
        <a href="{% url 'audit_log_list' %}" class="btn btn-dark px-4">
        View Audit Logs
    </a>
    </div>

    <!-- STAT CARDS -->
    <div class="row g-4">
        <div class="col-md-4">
            <div class="stat-card grad-blue">
                <p class="stat-title">Total Assets</p>
                <h2 class="stat-number">{{ total_assets }}</h2>
            </div>
        </div>

        <div class="col-md-4">
            <div class="stat-card grad-green">
                <p class="stat-title">Available</p>
                <h2 class="stat-number">{{ available_assets }}</h2>
            </div>
        </div>

        <div class="col-md-4">
            <div class="stat-card grad-red">
                <p class="stat-title">Unavailable</p>
                <h2 class="stat-number">{{ unavailable_assets }}</h2>
            </div>
        </div>
    </div>



    <!-- RECENT ASSETS -->
    <div class="card shadow-sm border-0 mt-5 table-box">

        <div class="card-header-custom">Recent Assets</div>

        <div class="table-responsive">
            <table class="table align-middle">

                <thead>
                    <tr>
                        <th class="ps-4">Name</th>
                        <th>Category</th>
                        <th>Status</th>
                        <th class="pe-4"></th>
                    </tr>
                </thead>

                <tbody>
                    {% for a in recent_assets %}
                    <tr>
                        <td class="fw-semibold ps-4">{{ a.name }}</td>
                        <td>{{ a.category }}</td>
                        <td>
                            {% if a.status == "available" %}
                                <span class="badge-soft-green">Available</span>
                            {% elif a.status == "unavailable" %}
                                <span class="badge-soft-red">Unavailable</span>
                            {% elif a.status == "checked_out" %}
                                <span class="badge-soft-purple">Checked Out</span>
                            {% endif %}
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="4" class="text-center text-muted py-4">No recent assets.</td>
                    </tr>
                    {% endfor %}
                </tbody>

            </table>
        </div>

    </div>




    <!-- RECENT MAINTENANCE -->
    <div class="card shadow-sm border-0 mt-5 table-box">

        <div class="card-header-custom">Recent Maintenance</div>

        <div class="table-responsive">
            <table class="table align-middle">

                <thead>
                    <tr>
                        <th class="ps-4">Asset</th>
                        <th>Start</th>
                        <th>End</th>
                        <th>Status</th>
                    </tr>
                </thead>

                <tbody>
                    {% for m in recent_maintenances %}
                    <tr>
                        <td class="ps-4 fw-semibold">
                            {{ m.asset.name }} ({{ m.asset.serial_number }})
                        </td>

                        <td>{{ m.start_date|date:"d M Y H:i" }}</td>
                        <td>{{ m.end_date|date:"d M Y H:i" }}</td>

                        <td>
                            {% if m.status == "in_progress" %}
                                <span class="badge-soft-purple">In Progress</span>
                            {% else %}
                                <span class="badge-soft-green">Done</span>
                            {% endif %}
                        </td>
                    </tr>

                    {% empty %}
                    <tr>
                        <td colspan="4" class="text-center text-muted py-4">No recent maintenance.</td>
                    </tr>
                    {% endfor %}
                </tbody>

            </table>
        </div>

    </div>

</div>

{% endblock %}
